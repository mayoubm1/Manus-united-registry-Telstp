"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useFrameAssembler = void 0;
const react_1 = require("react");
const frames_1 = require("@arwes/frames");
const react_animator_1 = require("@arwes/react-animator");
const useFrameAssembler = (svgRef) => {
    const animator = (0, react_animator_1.useAnimator)();
    (0, react_1.useEffect)(() => {
        const container = svgRef.current;
        if (!animator || !container) {
            return;
        }
        let animation;
        const unsubscribe = animator.node.subscribe((node) => {
            switch (node.state) {
                case 'entering': {
                    animation?.cancel();
                    animation = (0, frames_1.animateFrameAssembler)({
                        element: container,
                        duration: node.settings.duration.enter,
                        isEntering: true
                    });
                    break;
                }
                case 'exiting': {
                    animation?.cancel();
                    animation = (0, frames_1.animateFrameAssembler)({
                        element: container,
                        duration: node.settings.duration.exit,
                        isEntering: false
                    });
                    break;
                }
            }
        });
        return () => {
            animation?.cancel();
            unsubscribe();
        };
    }, [animator]);
};
exports.useFrameAssembler = useFrameAssembler;
