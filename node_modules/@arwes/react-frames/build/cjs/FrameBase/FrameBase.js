"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FrameBase = void 0;
const tslib_1 = require("tslib");
const react_1 = tslib_1.__importStar(require("react"));
const tools_1 = require("@arwes/tools");
const react_tools_1 = require("@arwes/react-tools");
const react_animator_1 = require("@arwes/react-animator");
const frames_1 = require("@arwes/frames");
const styles_js_1 = require("../internal/styles.js");
const FrameBase = (0, react_tools_1.memo)((props) => {
    const { elementRef, positioned = true, settings, className, style, preserveAspectRatio = 'none', children } = props;
    const animator = (0, react_animator_1.useAnimator)();
    const svgRef = (0, react_1.useRef)(null);
    const frameRef = (0, react_1.useRef)(null);
    const settingsRef = (0, react_1.useRef)(settings);
    Object.assign(settingsRef.current, settings, { animator: animator?.node });
    (0, react_1.useEffect)(() => {
        const svg = svgRef.current;
        if (!svg) {
            return;
        }
        frameRef.current = (0, frames_1.createFrame)(svg, settingsRef.current);
        return () => frameRef.current?.remove();
    }, [animator]);
    (0, react_tools_1.useUpdateEffect)(() => {
        frameRef.current?.render();
    }, [settings]);
    return (react_1.default.createElement("svg", { role: "presentation", ref: (0, react_tools_1.mergeRefs)(svgRef, elementRef), className: (0, tools_1.cx)('arwes-frames-frame', className), style: { ...(positioned ? styles_js_1.positionedStyle : null), ...style }, xmlns: "http://www.w3.org/2000/svg", preserveAspectRatio: preserveAspectRatio }, children));
});
exports.FrameBase = FrameBase;
