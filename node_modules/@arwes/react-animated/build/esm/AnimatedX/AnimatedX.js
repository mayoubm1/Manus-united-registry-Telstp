import { createElement, useRef, useMemo } from 'react';
import { mergeRefs } from '@arwes/react-tools';
import { formatAnimatedCSSProps } from '@arwes/animated';
import { useAnimatedX } from '../useAnimatedX/index.js';
const AnimatedX = (props) => {
    const { as: asProvided, state: animatedState, hideOnStates = [], animated, className, style, elementRef: externalElementRef, ...otherProps } = props;
    const hasState = animatedState !== undefined && animatedState !== null;
    const as = useMemo(() => asProvided || 'div', []);
    const elementRef = useRef(null);
    useAnimatedX(animatedState, elementRef, animated, { renderInitials: false, hideOnStates });
    const animatedSettingsListReceived = Array.isArray(animated) ? animated : [animated];
    const animatedSettingsList = animatedSettingsListReceived.filter(Boolean);
    let initialAttributes;
    if (hasState) {
        initialAttributes = animatedSettingsList
            .map((item) => item?.initialAttributes)
            .reduce((total, item) => ({ ...total, ...item }), {});
    }
    let dynamicStyles;
    if (hasState) {
        dynamicStyles = animatedSettingsList
            .map((item) => item.initialStyle)
            .filter(Boolean)
            .map((styles) => formatAnimatedCSSProps(styles))
            .reduce((total, item) => ({ ...total, ...item }), {});
    }
    return createElement(as, {
        ...otherProps,
        ...initialAttributes,
        ref: mergeRefs(externalElementRef, elementRef),
        className,
        style: {
            ...style,
            visibility: hasState && hideOnStates.includes(animatedState) ? 'hidden' : '',
            ...dynamicStyles
        }
    });
};
export { AnimatedX };
