"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.AnimatedX = void 0;
const react_1 = require("react");
const react_tools_1 = require("@arwes/react-tools");
const animated_1 = require("@arwes/animated");
const index_js_1 = require("../useAnimatedX/index.js");
const AnimatedX = (props) => {
    const { as: asProvided, state: animatedState, hideOnStates = [], animated, className, style, elementRef: externalElementRef, ...otherProps } = props;
    const hasState = animatedState !== undefined && animatedState !== null;
    const as = (0, react_1.useMemo)(() => asProvided || 'div', []);
    const elementRef = (0, react_1.useRef)(null);
    (0, index_js_1.useAnimatedX)(animatedState, elementRef, animated, { renderInitials: false, hideOnStates });
    const animatedSettingsListReceived = Array.isArray(animated) ? animated : [animated];
    const animatedSettingsList = animatedSettingsListReceived.filter(Boolean);
    let initialAttributes;
    if (hasState) {
        initialAttributes = animatedSettingsList
            .map((item) => item?.initialAttributes)
            .reduce((total, item) => ({ ...total, ...item }), {});
    }
    let dynamicStyles;
    if (hasState) {
        dynamicStyles = animatedSettingsList
            .map((item) => item.initialStyle)
            .filter(Boolean)
            .map((styles) => (0, animated_1.formatAnimatedCSSProps)(styles))
            .reduce((total, item) => ({ ...total, ...item }), {});
    }
    return (0, react_1.createElement)(as, {
        ...otherProps,
        ...initialAttributes,
        ref: (0, react_tools_1.mergeRefs)(externalElementRef, elementRef),
        className,
        style: {
            ...style,
            visibility: hasState && hideOnStates.includes(animatedState) ? 'hidden' : '',
            ...dynamicStyles
        }
    });
};
exports.AnimatedX = AnimatedX;
